# Jimeng API

ğŸ¨ **å…è´¹çš„AIå›¾åƒå’Œè§†é¢‘ç”ŸæˆAPIæœåŠ¡** - åŸºäºå³æ¢¦AIï¼ˆå›½å†…ç«™ï¼‰å’Œdreaminaï¼ˆå›½é™…ç«™ï¼‰çš„é€†å‘å·¥ç¨‹å®ç°ï¼Œæä¾›ä¸OpenAI APIå…¼å®¹çš„æ¥å£æ ¼å¼

[![Node.js](https://img.shields.io/badge/Node.js-18+-green.svg)](https://nodejs.org/) [![TypeScript](https://img.shields.io/badge/TypeScript-5.0+-blue.svg)](https://www.typescriptlang.org/) [![Docker](https://img.shields.io/badge/Docker-æ”¯æŒ-blue.svg)](https://www.docker.com/) [![License](https://img.shields.io/badge/License-GPL%20v3-blue.svg)](LICENSE)

## âœ¨ ç‰¹æ€§

- ğŸ¨ **AIå›¾åƒç”Ÿæˆ**: æ”¯æŒå¤šç§æ¨¡å‹å’Œåˆ†è¾¨ç‡ï¼ˆé»˜è®¤2Kï¼Œæ”¯æŒ4Kï¼‰
- ğŸ–¼ï¸ **å›¾ç”Ÿå›¾åˆæˆ**: æ”¯æŒå¤šå›¾æ··åˆã€é£æ ¼è½¬æ¢ã€å†…å®¹åˆæˆ
- ğŸ¬ **AIè§†é¢‘ç”Ÿæˆ**: æ”¯æŒæ–‡æœ¬åˆ°è§†é¢‘ç”Ÿæˆ
- ğŸŒ **å›½é™…ç«™æ”¯æŒ**: æ–°å¢å¯¹å³æ¢¦å›½é™…ç«™ï¼ˆdreaminaï¼‰æ–‡ç”Ÿå›¾APIçš„æ”¯æŒï¼Œå¯èƒ½ä¸ç¨³å®šï¼Œæœ‰é—®é¢˜æissue
- ğŸ’¬ **èŠå¤©æ¥å£**: OpenAIç”Ÿå›¾æ ¼å¼å…¼å®¹çš„API
- ğŸ”„ **æ™ºèƒ½è½®è¯¢**: è‡ªé€‚åº”è½®è¯¢æœºåˆ¶ï¼Œä¼˜åŒ–ç”Ÿæˆæ•ˆç‡
- ğŸ›¡ï¸ **ç»Ÿä¸€å¼‚å¸¸å¤„ç†**: å®Œå–„çš„é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶
- ğŸ“Š **è¯¦ç»†æ—¥å¿—**: ç»“æ„åŒ–æ—¥å¿—è®°å½•ï¼Œä¾¿äºè°ƒè¯•
- ğŸ³ **Dockeræ”¯æŒ**: å®¹å™¨åŒ–éƒ¨ç½²ï¼Œå¼€ç®±å³ç”¨

## âš  é£é™©è­¦å‘Š

- æ­¤é¡¹ç›®å±äºç ”ç©¶äº¤æµå­¦ä¹ æ€§è´¨ï¼Œä¸æ¥å—ä»»ä½•èµ„é‡‘æåŠ©å’Œé‡‘é’±äº¤æ˜“ï¼
- ä»…é™è‡ªç”¨å’Œä¸ªäººç ”ç©¶ï¼Œé¿å…å¯¹å®˜æ–¹é€ æˆæœåŠ¡å‹åŠ›ï¼Œå¦åˆ™è½»è€…å¯èƒ½å°å·ï¼Œé‡è€…å¯èƒ½è§¦çŠ¯æ³•å¾‹ï¼
- ä»…é™è‡ªç”¨å’Œä¸ªäººç ”ç©¶ï¼Œé¿å…å¯¹å®˜æ–¹é€ æˆæœåŠ¡å‹åŠ›ï¼Œå¦åˆ™è½»è€…å¯èƒ½å°å·ï¼Œé‡è€…å¯èƒ½è§¦çŠ¯æ³•å¾‹ï¼
- ä»…é™è‡ªç”¨å’Œä¸ªäººç ”ç©¶ï¼Œé¿å…å¯¹å®˜æ–¹é€ æˆæœåŠ¡å‹åŠ›ï¼Œå¦åˆ™è½»è€…å¯èƒ½å°å·ï¼Œé‡è€…å¯èƒ½è§¦çŠ¯æ³•å¾‹ï¼

## âœ¨ æ–°åŠŸèƒ½äº®ç‚¹

### ğŸ“ ratioå’Œresolutionå‚æ•°æ”¯æŒ

ç°åœ¨é€šè¿‡`ratio`å’Œ`resolution`ä¸¤ä¸ªå‚æ•°æ¥å…±åŒæ§åˆ¶å›¾åƒå°ºå¯¸ï¼Œè¿™æä¾›äº†æ›´é«˜çš„çµæ´»æ€§ã€‚ç¨‹åºå†…`resolution`é»˜è®¤è®¾ç½®ä¸º`2k`ã€‚

```bash
curl -X POST http://localhost:5100/v1/images/generations \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_SESSION_ID" \
  -d '{
    "model": "jimeng-4.0",
    "prompt": "ç¾ä¸½çš„å°‘å¥³ï¼Œèƒ¶ç‰‡æ„Ÿ",
    "ratio": "4:3",
    "resolution": "2k"
  }'
```

**æ”¯æŒçš„resolution**: `2k`, `4k`

**æ”¯æŒçš„ratio**: `1:1`, `4:3`, `3:4`, `16:9`, `9:16`, `3:2`, `2:3`, `21:9`

## ğŸš€ å¿«é€Ÿå¼€å§‹

### sessionidè·å–
- å›½å†…ç«™ (å³æ¢¦)å’Œå›½é™…ç«™ (dreamina)è·å–sessionidçš„æ–¹æ³•ç›¸åŒï¼Œè§ä¸‹å›¾ã€‚
> **æ³¨æ„**: å›½å†…ç«™å’Œå›½é™…ç«™apiæ¥å£ç›¸åŒï¼Œä½†å›½é™…ç«™çš„sessionidéœ€è¦æ‰‹åŠ¨æ·»åŠ **us-**ï¼Œæ¯”å¦‚`Bearer us-xxxxx`ï¼Œæ‰èƒ½è®¿é—®å›½é™…ç«™ï¼Œå¦åˆ™é»˜è®¤å›½å†…ç«™ã€‚

![](https://github.com/iptag/jimeng-api/blob/main/get_sessionid.png)

### ç¯å¢ƒè¦æ±‚

- Node.js 18+
- npm æˆ– yarn
- Docker (å¯é€‰)

### å®‰è£…éƒ¨ç½²

#### æ–¹å¼ä¸€ï¼šç›´æ¥æ‹‰å–dockeré•œåƒ

```bash
docker run -d \
  --name jimeng-api \
  -p 5100:5100 \
  --restart unless-stopped \
  iptag/jimeng:latest
```

#### æ–¹å¼äºŒï¼šç›´æ¥è¿è¡Œ

```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd jimeng-api

# å®‰è£…ä¾èµ–
npm install

# ç¼–è¯‘æ–‡ä»¶
npm run build

# å¯åŠ¨æœåŠ¡
npm run dev
```

#### æ–¹å¼ä¸‰ï¼šDockeréƒ¨ç½²ï¼ˆæ¨èï¼‰

##### ğŸš€ å¿«é€Ÿå¯åŠ¨
```bash
# ä½¿ç”¨docker-composeï¼ˆæ¨èï¼‰
docker-compose up -d

# æˆ–è€…æ‰‹åŠ¨æ„å»ºå’Œè¿è¡Œ
docker build -t jimeng-api .

docker run -d \
  --name jimeng-api \
  -p 5100:5100 \
  --restart unless-stopped \
  jimeng-api
```

##### ğŸ”§ å¸¸ç”¨å‘½ä»¤
```bash
# é‡æ–°æ„å»ºå¹¶å¯åŠ¨
docker-compose up -d --build

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
docker logs jimeng-api

# åœæ­¢æœåŠ¡
docker-compose down

# è¿›å…¥å®¹å™¨è°ƒè¯•
docker exec -it jimeng-api sh
```

##### ğŸ“Š Dockeré•œåƒç‰¹æ€§
- âœ… **å¤šé˜¶æ®µæ„å»º**ï¼šä¼˜åŒ–é•œåƒå¤§å°ï¼ˆ167MBï¼‰
- âœ… **érootç”¨æˆ·**ï¼šå¢å¼ºå®‰å…¨æ€§ï¼ˆjimengç”¨æˆ·ï¼‰
- âœ… **å¥åº·æ£€æŸ¥**ï¼šè‡ªåŠ¨ç›‘æ§æœåŠ¡çŠ¶æ€
- âœ… **ç»Ÿä¸€ç«¯å£**ï¼šå®¹å™¨å†…å¤–å‡ä½¿ç”¨5100ç«¯å£
- âœ… **æ—¥å¿—ç®¡ç†**ï¼šç»“æ„åŒ–æ—¥å¿—è¾“å‡º

### é…ç½®è¯´æ˜

#### `configs/dev/service.yml`
```yaml
name: jimeng-api
route: src/api/routes/index.ts
port: 5100
```

#### `configs/dev/system.yml`
```yaml
requestLog: true
debug: false
```

## ğŸ“– APIæ–‡æ¡£

### ğŸŒ å›½é™…ç«™æ”¯æŒ (dreamina)

é™¤äº†æ”¯æŒå›½å†…ç‰ˆçš„å³æ¢¦AIï¼Œé¡¹ç›®ç°å·²é›†æˆå¯¹å›½é™…ç«™ **dreamina** çš„æ”¯æŒã€‚

- **å¦‚ä½•ä½¿ç”¨**: ä½¿ç”¨ä»å›½é™…ç«™è·å–çš„ `sessionid` ï¼Œå¹¶ä¸”éœ€è¦æ‰‹åŠ¨æ·»åŠ **us-**ï¼Œæ¯”å¦‚`Bearer us-xxxxx`ï¼Œæ‰èƒ½è®¿é—®å›½é™…ç«™ï¼Œå¦åˆ™é»˜è®¤å›½å†…ç«™ã€‚

### å›¾åƒç”Ÿæˆ

**POST** `/v1/images/generations`

**è¯·æ±‚å‚æ•°**:
- `model` (string): ä½¿ç”¨çš„æ¨¡å‹åç§°
- `prompt` (string): å›¾åƒæè¿°æ–‡æœ¬
- `ratio` (string, å¯é€‰): å›¾åƒæ¯”ä¾‹ï¼Œé»˜è®¤ä¸º `"1:1"`ã€‚æ”¯æŒçš„æ¯”ä¾‹: `1:1`, `4:3`, `3:4`, `16:9`, `9:16`, `3:2`, `2:3`, `21:9`ã€‚
- `resolution` (string, å¯é€‰): åˆ†è¾¨ç‡çº§åˆ«ï¼Œé»˜è®¤ä¸º `"2k"`ã€‚æ”¯æŒçš„åˆ†è¾¨ç‡: `2k`, `4k`ã€‚
- `negative_prompt` (string, å¯é€‰): è´Ÿé¢æç¤ºè¯
- `sample_strength` (number, å¯é€‰): é‡‡æ ·å¼ºåº¦ (0.0-1.0)
- `response_format` (string, å¯é€‰): å“åº”æ ¼å¼ ("url" æˆ– "b64_json")

```bash
# é»˜è®¤å‚æ•°ï¼ˆratio: "1:1", resolution: "2k"ï¼‰
curl -X POST http://localhost:5100/v1/images/generations \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_SESSION_ID" \
  -d '{
    "model": "jimeng-4.0",
    "prompt": "ä¸€åªå¯çˆ±çš„å°çŒ«å’ª"
  }'

# ä½¿ç”¨4Kåˆ†è¾¨ç‡çš„ç¤ºä¾‹
curl -X POST http://localhost:5100/v1/images/generations \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_SESSION_ID" \
  -d '{
    "model": "jimeng-4.0",
    "prompt": "å£®ä¸½çš„å±±æ°´é£æ™¯ï¼Œè¶…é«˜åˆ†è¾¨ç‡",
    "ratio": "16:9",
    "resolution": "4k"
  }'
```

**æ”¯æŒçš„æ¨¡å‹**:
- `jimeng-4.0`
- `jimeng-3.1` è°ƒç”¨4.0ä»¥ä¸‹æ¨¡å‹æ—¶é¡»æœ‰å®˜ç½‘è´­ä¹°çš„ç§¯åˆ†ï¼Œæ¯æ—¥èµ é€çš„ä¸è¡Œï¼Œä¸ç„¶ä¼šæç¤ºç§¯åˆ†ä¸å¤Ÿ
- `jimeng-3.0`
- `jimeng-2.1`
- `jimeng-xl-pro`


**æ”¯æŒçš„æ¯”ä¾‹åŠå¯¹åº”åˆ†è¾¨ç‡** ï¼š
| resolution | ratio | åˆ†è¾¨ç‡ |
|---|---|---|
| `2k` (é»˜è®¤) | `1:1` | 2048Ã—2048 |
| | `4:3` | 2304Ã—1728 |
| | `3:4` | 1728Ã—2304 |
| | `16:9` | 2560Ã—1440 |
| | `9:16` | 1440Ã—2560 |
| | `3:2` | 2496Ã—1664 |
| | `2:3` | 1664Ã—2496 |
| | `21:9` | 3024Ã—1296 |
| `4k` | `1:1` | 4096Ã—4096 |
| | `4:3` | 4608Ã—3456 |
| | `3:4` | 3456Ã—4608 |
| | `16:9` | 5120Ã—2880 |
| | `9:16` | 2880Ã—5120 |
| | `3:2` | 4992Ã—3328 |
| | `2:3` | 3328Ã—4992 |
| | `21:9` | 6048Ã—2592 |

### å›¾ç”Ÿå›¾ (å›¾ç‰‡åˆæˆ)

**POST** `/v1/images/compositions`

**åŠŸèƒ½è¯´æ˜**: åŸºäºè¾“å…¥çš„ä¸€å¼ æˆ–å¤šå¼ å›¾ç‰‡ï¼Œç»“åˆæ–‡æœ¬æç¤ºè¯ç”Ÿæˆæ–°çš„å›¾ç‰‡ã€‚æ”¯æŒå›¾ç‰‡æ··åˆã€é£æ ¼è½¬æ¢ã€å†…å®¹åˆæˆç­‰å¤šç§åˆ›ä½œæ¨¡å¼ã€‚

**è¯·æ±‚å‚æ•°**:
- `model` (string): ä½¿ç”¨çš„æ¨¡å‹åç§°
- `prompt` (string): å›¾åƒæè¿°æ–‡æœ¬ï¼Œç”¨äºæŒ‡å¯¼ç”Ÿæˆæ–¹å‘
- `images` (array): è¾“å…¥å›¾ç‰‡æ•°ç»„
- `ratio` (string, å¯é€‰): å›¾åƒæ¯”ä¾‹ï¼Œé»˜è®¤ä¸º `"1:1"`ã€‚æ”¯æŒçš„æ¯”ä¾‹: `1:1`, `4:3`, `3:4`, `16:9`, `9:16`, `3:2`, `2:3`, `21:9`ã€‚
- `resolution` (string, å¯é€‰): åˆ†è¾¨ç‡çº§åˆ«ï¼Œé»˜è®¤ä¸º `"2k"`ã€‚æ”¯æŒçš„åˆ†è¾¨ç‡: `2k`, `4k`ã€‚
- `negative_prompt` (string, å¯é€‰): è´Ÿé¢æç¤ºè¯
- `sample_strength` (number, å¯é€‰): é‡‡æ ·å¼ºåº¦ (0.0-1.0)
- `response_format` (string, å¯é€‰): å“åº”æ ¼å¼ ("url" æˆ– "b64_json")

**ä½¿ç”¨é™åˆ¶**:
- è¾“å…¥å›¾ç‰‡æ•°é‡: 1-10å¼ 
- æ”¯æŒçš„å›¾ç‰‡æ ¼å¼: JPG, PNG, WebPç­‰å¸¸è§æ ¼å¼
- å›¾ç‰‡å¤§å°é™åˆ¶: å»ºè®®å•å¼ å›¾ç‰‡ä¸è¶…è¿‡10MB
- ç”Ÿæˆæ—¶é—´: é€šå¸¸30ç§’-5åˆ†é’Ÿï¼Œå¤æ‚åˆæˆå¯èƒ½éœ€è¦æ›´é•¿æ—¶é—´

**ä½¿ç”¨ç¤ºä¾‹**:

```bash
# å•å›¾é£æ ¼è½¬æ¢ (2Kåˆ†è¾¨ç‡)
curl -X POST http://localhost:5100/v1/images/compositions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_SESSION_ID" \
  -d '{
    "model": "jimeng-4.0",
    "prompt": "å°†è¿™å¼ ç…§ç‰‡è½¬æ¢ä¸ºæ²¹ç”»é£æ ¼ï¼Œè‰²å½©é²œè‰³ï¼Œç¬”è§¦æ˜æ˜¾",
    "images": ["https://example.com/photo.jpg"],
    "ratio": "1:1",
    "resolution": "2k",
    "sample_strength": 0.7
  }'

# å¤šå›¾æ··åˆåˆæˆ (4Kåˆ†è¾¨ç‡)
curl -X POST http://localhost:5100/v1/images/compositions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_SESSION_ID" \
  -d '{
    "model": "jimeng-4.0",
    "prompt": "å°†è¿™äº›å›¾ç‰‡èåˆæˆä¸€å¹…æ¢¦å¹»çš„è¶…ç°å®ä¸»ä¹‰ä½œå“",
    "images": [
      "https://example.com/landscape.jpg",
      "https://example.com/portrait.jpg"
    ],
    "ratio": "4:3",
    "resolution": "4k",
    "negative_prompt": "æ¨¡ç³Šï¼Œä½è´¨é‡ï¼Œå˜å½¢"
  }'
```
```

**è¯¦ç»†æµç¨‹è¯´æ˜**:

#### ğŸ”„ **å®Œæ•´å¤„ç†æµç¨‹**

1. **è¯·æ±‚éªŒè¯é˜¶æ®µ** (1-2ç§’)
   - éªŒè¯è¯·æ±‚å‚æ•°æ ¼å¼å’Œå®Œæ•´æ€§
   - æ£€æŸ¥å›¾ç‰‡æ•°ç»„æ˜¯å¦ç¬¦åˆè¦æ±‚ (1-10å¼ )
   - éªŒè¯æ¯ä¸ªå›¾ç‰‡URLçš„æ ¼å¼

2. **å›¾ç‰‡é¢„å¤„ç†é˜¶æ®µ** (5-30ç§’ï¼Œå–å†³äºå›¾ç‰‡æ•°é‡å’Œå¤§å°)
   - **ä¸‹è½½å¤–éƒ¨å›¾ç‰‡**: ä»æä¾›çš„URLä¸‹è½½å›¾ç‰‡åˆ°æœ¬åœ°
   - **è·å–ä¸Šä¼ ä»¤ç‰Œ**: å‘å³æ¢¦/dreaminaæœåŠ¡å™¨ç”³è¯·å›¾ç‰‡ä¸Šä¼ æƒé™
   - **å›¾ç‰‡ä¸Šä¼ **: ä½¿ç”¨AWSç­¾åè®¤è¯å°†å›¾ç‰‡ä¸Šä¼ åˆ°å³æ¢¦/dreaminaå­˜å‚¨ç³»ç»Ÿ
   - **æ ¼å¼è½¬æ¢**: è‡ªåŠ¨å¤„ç†å›¾ç‰‡æ ¼å¼å’Œå°ºå¯¸ä¼˜åŒ–

3. **ä»»åŠ¡æäº¤é˜¶æ®µ** (2-5ç§’)
   - æ„å»ºå›¾ç‰‡åˆæˆä»»åŠ¡å‚æ•°
   - è®¾ç½®åˆæˆæ¨¡å¼ä¸º "blend" (æ··åˆæ¨¡å¼)
   - æäº¤ä»»åŠ¡åˆ°å³æ¢¦/dreaminaç”Ÿæˆé˜Ÿåˆ—
   - è·å–ä»»åŠ¡ID (history_id)

4. **AIç”Ÿæˆé˜¶æ®µ** (30ç§’-5åˆ†é’Ÿ)
   - AIæ¨¡å‹åˆ†æè¾“å…¥å›¾ç‰‡å’Œæ–‡æœ¬æç¤º
   - æ‰§è¡Œå›¾ç‰‡æ··åˆã€é£æ ¼è½¬æ¢æˆ–å†…å®¹åˆæˆ
   - ç”Ÿæˆè¿‡ç¨‹ä¸­ç³»ç»Ÿä¼šå®šæœŸæ£€æŸ¥çŠ¶æ€

5. **ç»“æœè½®è¯¢é˜¶æ®µ** (æŒç»­è¿›è¡Œï¼Œç›´åˆ°å®Œæˆ)
   - æ¯ç§’æŸ¥è¯¢ä¸€æ¬¡ç”ŸæˆçŠ¶æ€
   - æœ€å¤šè½®è¯¢600æ¬¡ (10åˆ†é’Ÿè¶…æ—¶)
   - æ¯30ç§’è¾“å‡ºä¸€æ¬¡è¿›åº¦æ—¥å¿—

6. **ç»“æœå¤„ç†é˜¶æ®µ** (1-3ç§’)
   - æå–ç”Ÿæˆçš„å›¾ç‰‡URL
   - æ ¹æ® `response_format` å‚æ•°å†³å®šè¿”å›æ ¼å¼
   - å¦‚æœæ˜¯ "b64_json"ï¼Œåˆ™ä¸‹è½½å›¾ç‰‡å¹¶è½¬æ¢ä¸ºBase64

#### âš¡ **æ€§èƒ½ä¼˜åŒ–ç‰¹æ€§**

- **å¹¶å‘ä¸Šä¼ **: å¤šå¼ å›¾ç‰‡å¹¶è¡Œä¸Šä¼ ï¼Œæå‡å¤„ç†é€Ÿåº¦
- **æ™ºèƒ½é‡è¯•**: ç½‘ç»œå¼‚å¸¸æ—¶è‡ªåŠ¨é‡è¯•ä¸Šä¼ 
- **çŠ¶æ€ç¼“å­˜**: é¿å…é‡å¤æŸ¥è¯¢ç›¸åŒçŠ¶æ€
- **èµ„æºç®¡ç†**: è‡ªåŠ¨æ¸…ç†ä¸´æ—¶æ–‡ä»¶å’Œè¿æ¥

#### ğŸ›¡ï¸ **é”™è¯¯å¤„ç†æœºåˆ¶**

- **å›¾ç‰‡ä¸‹è½½å¤±è´¥**: è¿”å›å…·ä½“çš„ç½‘ç»œé”™è¯¯ä¿¡æ¯
- **ä¸Šä¼ æƒé™å¼‚å¸¸**: è‡ªåŠ¨é‡æ–°ç”³è¯·ä¸Šä¼ ä»¤ç‰Œ
- **ç”Ÿæˆè¶…æ—¶**: 10åˆ†é’Ÿåè¿”å›è¶…æ—¶é”™è¯¯
- **å†…å®¹å®¡æ ¸**: å¦‚æœå†…å®¹è¢«è¿‡æ»¤ï¼Œè¿”å›ç›¸åº”é”™è¯¯ç 
- **ç§¯åˆ†ä¸è¶³**: è‡ªåŠ¨å°è¯•é¢†å–å…è´¹ç§¯åˆ†

#### ğŸ“‹ **å“åº”æ ¼å¼**

**æˆåŠŸå“åº”** (response_format: "url"):
```json
{
  "created": 1703123456,
  "data": [
    {
      "url": "https://p3-sign.toutiaoimg.com/tos-cn-i-tb4s082cfz/abc123.webp"
    }
  ],
  "input_images": 2,
  "composition_type": "multi_image_synthesis"
}
```

**æˆåŠŸå“åº”** (response_format: "b64_json"):
```json
{
  "created": 1703123456,
  "data": [
    {
      "b64_json": "iVBORw0KGgoAAAANSUhEUgAA..."
    }
  ],
  "input_images": 2,
  "composition_type": "multi_image_synthesis"
}
```

**é”™è¯¯å“åº”**:
```json
{
  "error": {
    "message": "å›¾ç‰‡ä¸Šä¼ å¤±è´¥: ç½‘ç»œè¿æ¥è¶…æ—¶",
    "type": "image_upload_error",
    "code": "UPLOAD_TIMEOUT"
  }
}
```

#### â“ **å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ**

**Q: å›¾ç‰‡ä¸Šä¼ å¤±è´¥æ€ä¹ˆåŠï¼Ÿ**
A: æ£€æŸ¥å›¾ç‰‡URLæ˜¯å¦å¯è®¿é—®ï¼Œç¡®ä¿å›¾ç‰‡æ ¼å¼æ­£ç¡®ï¼Œæ–‡ä»¶å¤§å°ä¸è¶…è¿‡10MBã€‚

**Q: ç”Ÿæˆæ—¶é—´è¿‡é•¿æ€ä¹ˆåŠï¼Ÿ**
A: å¤æ‚çš„å¤šå›¾åˆæˆéœ€è¦æ›´é•¿æ—¶é—´ï¼Œå»ºè®®è€å¿ƒç­‰å¾…ã€‚å¦‚æœè¶…è¿‡10åˆ†é’Ÿä»æœªå®Œæˆï¼Œå¯ä»¥é‡æ–°æäº¤è¯·æ±‚ã€‚

**Q: å¦‚ä½•æé«˜åˆæˆè´¨é‡ï¼Ÿ**
A:
- ä½¿ç”¨é«˜è´¨é‡çš„è¾“å…¥å›¾ç‰‡
- ç¼–å†™è¯¦ç»†å‡†ç¡®çš„æç¤ºè¯
- é€‚å½“è°ƒæ•´ `sample_strength` å‚æ•°
- é¿å…ä½¿ç”¨è¿‡å¤šå†²çªçš„å›¾ç‰‡é£æ ¼

**Q: æ”¯æŒå“ªäº›å›¾ç‰‡æ ¼å¼ï¼Ÿ**
A: æ”¯æŒ JPGã€PNGã€WebPã€GIF ç­‰å¸¸è§æ ¼å¼ï¼Œæ¨èä½¿ç”¨ JPG æˆ– PNGã€‚

**Q: å¯ä»¥ä½¿ç”¨æœ¬åœ°å›¾ç‰‡å—ï¼Ÿ**
A: éœ€è¦å…ˆå°†æœ¬åœ°å›¾ç‰‡ä¸Šä¼ åˆ°å¯è®¿é—®çš„ç½‘ç»œåœ°å€ï¼Œç„¶åä½¿ç”¨è¯¥URLã€‚

### è§†é¢‘ç”Ÿæˆ

**POST** `/v1/chat/completions`

```bash
curl -X POST http://localhost:5100/v1/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_SESSION_ID" \
  -d '{
    "model": "jimeng-video-3.0",
    "messages": [
      {
        "role": "user",
        "content": "ç”Ÿæˆä¸€ä¸ªæµ·æµªæ‹æ‰“æµ·å²¸çš„è§†é¢‘"
      }
    ],
    "stream": true
  }'
```

**æ”¯æŒçš„è§†é¢‘æ¨¡å‹**:
- `jimeng-video-3.0-pro` - ä¸“ä¸šç‰ˆ
- `jimeng-video-3.0` - æ ‡å‡†ç‰ˆ
- `jimeng-video-2.0-pro` - ä¸“ä¸šç‰ˆv2
- `jimeng-video-2.0` - æ ‡å‡†ç‰ˆv2

### èŠå¤©å®Œæˆ

**POST** `/v1/chat/completions`

```bash
curl -X POST http://localhost:5100/v1/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_SESSION_ID" \
  -d '{
    "model": "jimeng-4.0",
    "messages": [
      {
        "role": "user",
        "content": "ç”»ä¸€å¹…å±±æ°´ç”»"
      }
    ]
  }'
```

## ğŸ” APIå“åº”æ ¼å¼

### å›¾åƒç”Ÿæˆå“åº”
```json
{
  "created": 1759058768,
  "data": [
    {
      "url": "https://example.com/image1.jpg"
    },
    {
      "url": "https://example.com/image2.jpg"
    }
  ]
}
```

### èŠå¤©å®Œæˆå“åº”
```json
{
  "id": "chatcmpl-123",
  "object": "chat.completion",
  "created": 1759058768,
  "model": "jimeng-4.0",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "![image](https://example.com/generated-image.jpg)"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 10,
    "completion_tokens": 20,
    "total_tokens": 30
  }
}
```

### æµå¼å“åº” (SSE)
```
data: {"id":"chatcmpl-123","object":"chat.completion.chunk","created":1759058768,"model":"jimeng-4.0","choices":[{"index":0,"delta":{"role":"assistant","content":"ğŸ¨ å›¾åƒç”Ÿæˆä¸­ï¼Œè¯·ç¨å€™..."},"finish_reason":null}]}

data: {"id":"chatcmpl-123","object":"chat.completion.chunk","created":1759058768,"model":"jimeng-4.0","choices":[{"index":1,"delta":{"role":"assistant","content":"![image](https://example.com/image.jpg)"},"finish_reason":"stop"}]}

data: [DONE]
```

## ğŸ—ï¸ é¡¹ç›®æ¶æ„

```
jimeng-api/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ controllers/          # æ§åˆ¶å™¨å±‚
â”‚   â”‚   â”‚   â”œâ”€â”€ core.ts          # æ ¸å¿ƒåŠŸèƒ½ï¼ˆç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶å¤„ç†ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ images.ts        # å›¾åƒç”Ÿæˆé€»è¾‘
â”‚   â”‚   â”‚   â”œâ”€â”€ videos.ts        # è§†é¢‘ç”Ÿæˆé€»è¾‘
â”‚   â”‚   â”‚   â””â”€â”€ chat.ts          # èŠå¤©æ¥å£é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ routes/              # è·¯ç”±å®šä¹‰
â”‚   â”‚   â””â”€â”€ consts/              # å¸¸é‡å®šä¹‰
â”‚   â”‚       â”œâ”€â”€ exceptions.ts    # å¼‚å¸¸å®šä¹‰
â”‚   â”‚       â””â”€â”€ common.ts        # é€šç”¨å¸¸é‡
â”‚   â”œâ”€â”€ lib/                     # æ ¸å¿ƒåº“
â”‚   â”‚   â”œâ”€â”€ server.ts           # æœåŠ¡å™¨æ ¸å¿ƒ
â”‚   â”‚   â”œâ”€â”€ error-handler.ts    # ç»Ÿä¸€é”™è¯¯å¤„ç†
â”‚   â”‚   â”œâ”€â”€ smart-poller.ts     # æ™ºèƒ½è½®è¯¢å™¨
â”‚   â”‚   â”œâ”€â”€ aws-signature.ts    # AWSç­¾å
â”‚   â”‚   â””â”€â”€ exceptions/         # å¼‚å¸¸ç±»
â”‚   â”œâ”€â”€ daemon.ts               # å®ˆæŠ¤è¿›ç¨‹
â”‚   â””â”€â”€ index.ts               # å…¥å£æ–‡ä»¶
â”œâ”€â”€ configs/                    # é…ç½®æ–‡ä»¶
â”œâ”€â”€ Dockerfile                 # Dockeré…ç½®
â””â”€â”€ package.json              # é¡¹ç›®é…ç½®
```

## ğŸ”§ æ ¸å¿ƒç»„ä»¶

### æ™ºèƒ½è½®è¯¢å™¨ (SmartPoller)
- åŸºäºçŠ¶æ€ç è‡ªé€‚åº”è°ƒæ•´è½®è¯¢é—´éš”
- å¤šé‡é€€å‡ºæ¡ä»¶ï¼Œé¿å…æ— æ•ˆç­‰å¾…
- è¯¦ç»†çš„è¿›åº¦è·Ÿè¸ªå’Œæ—¥å¿—è®°å½•

### ç»Ÿä¸€é”™è¯¯å¤„ç† (ErrorHandler)
- åˆ†ç±»é”™è¯¯å¤„ç†ï¼ˆç½‘ç»œé”™è¯¯ã€APIé”™è¯¯ã€è¶…æ—¶ç­‰ï¼‰
- è‡ªåŠ¨é‡è¯•æœºåˆ¶
- ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º

### å®‰å…¨JSONè§£æ
- è‡ªåŠ¨ä¿®å¤å¸¸è§JSONæ ¼å¼é—®é¢˜
- æ”¯æŒå°¾éšé€—å·ã€å•å¼•å·ç­‰éæ ‡å‡†æ ¼å¼
- è¯¦ç»†çš„è§£æé”™è¯¯æ—¥å¿—


## âš™ï¸ é«˜çº§é…ç½®

### è½®è¯¢é…ç½®
```typescript
export const POLLING_CONFIG = {
  MAX_POLL_COUNT: 900,    // æœ€å¤§è½®è¯¢æ¬¡æ•° (15åˆ†é’Ÿ)
  POLL_INTERVAL: 1000,    // åŸºç¡€è½®è¯¢é—´éš” (1ç§’)
  STABLE_ROUNDS: 5,       // ç¨³å®šè½®æ¬¡
  TIMEOUT_SECONDS: 900    // è¶…æ—¶æ—¶é—´ (15åˆ†é’Ÿ)
};
```

### é‡è¯•é…ç½®
```typescript
export const RETRY_CONFIG = {
  MAX_RETRY_COUNT: 3,     // æœ€å¤§é‡è¯•æ¬¡æ•°
  RETRY_DELAY: 5000       // é‡è¯•å»¶è¿Ÿ (5ç§’)
};
```

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **JSONè§£æé”™è¯¯**
   - æ£€æŸ¥è¯·æ±‚ä½“æ ¼å¼æ˜¯å¦æ­£ç¡®
   - ç³»ç»Ÿä¼šè‡ªåŠ¨ä¿®å¤å¸¸è§æ ¼å¼é—®é¢˜

2. **Sessionidå¤±æ•ˆ**
   - é‡æ–°è·å–å¯¹åº”ç«™ç‚¹çš„Sessionid
   - æ£€æŸ¥Sessionidæ ¼å¼æ˜¯å¦æ­£ç¡®

3. **ç”Ÿæˆè¶…æ—¶**
   - å›¾åƒç”Ÿæˆï¼šé€šå¸¸1-3åˆ†é’Ÿ
   - è§†é¢‘ç”Ÿæˆï¼šé€šå¸¸3-15åˆ†é’Ÿ
   - ç³»ç»Ÿä¼šè‡ªåŠ¨å¤„ç†è¶…æ—¶æƒ…å†µ

4. **ç§¯åˆ†ä¸è¶³**
   - å‰å¾€å³æ¢¦/dreaminaå®˜ç½‘æŸ¥çœ‹ç§¯åˆ†ä½™é¢
   - ç³»ç»Ÿä¼šæä¾›è¯¦ç»†çš„ç§¯åˆ†çŠ¶æ€ä¿¡æ¯

## ğŸ™ è‡´è°¢

æœ¬é¡¹ç›®åŸºäºä»¥ä¸‹å¼€æºé¡¹ç›®çš„è´¡çŒ®å’Œå¯å‘ï¼š

- **[jimeng-free-api-all](https://github.com/wwwzhouhui/jimeng-free-api-all)** - æ„Ÿè°¢è¯¥é¡¹ç›®ä¸ºå³æ¢¦APIé€†å‘å·¥ç¨‹æä¾›çš„é‡è¦å‚è€ƒå’ŒæŠ€æœ¯åŸºç¡€ï¼Œæœ¬é¡¹ç›®åœ¨å…¶åŸºç¡€ä¸Šè¿›è¡Œäº†åŠŸèƒ½å®Œå–„å’Œæ¶æ„ä¼˜åŒ–

## ğŸ“„ è®¸å¯è¯

GPL v3 License - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

## âš ï¸ å…è´£å£°æ˜

æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ï¼Œè¯·éµå®ˆç›¸å…³æœåŠ¡æ¡æ¬¾å’Œæ³•å¾‹æ³•è§„ã€‚ä½¿ç”¨æœ¬é¡¹ç›®æ‰€äº§ç”Ÿçš„ä»»ä½•åæœç”±ä½¿ç”¨è€…è‡ªè¡Œæ‰¿æ‹…ã€‚
